API 명세서 (프로젝트: dororo)
기준 소스: backend(Django REST) + frontend(Next.js) 현재 코드 확인 내용

공통
- 백엔드 베이스 URL: 루트 뒤에 `/api/` 프리픽스 사용 (project urls.py 기준).
- 인증: `rest_framework_simplejwt` 기반 JWT 설정 존재. 현재 연결된 API들은 인증 데코레이터가 없어 토큰 없이 호출 가능하며, 로그인/구글 로그인 시 토큰을 발급한다.
- 모델: 사용자 추가 정보는 `apps.users.models.LocalAccount`에 저장(필드: user FK, phone_number, nickname, type, role 등). 회원가입 시 role은 강제로 "student"로 저장.

[백엔드] Users API (`backend/apps/users`)
1) 학생 로그인
- URL: POST /api/users/student/login/
- 요청 Body(JSON):
  - email(string, required)
  - password(string, required)
- 처리: 이메일로 User 조회 → 비밀번호 검증 → LocalAccount.role 이 "student"인지 확인 → JWT 발급
- 성공(200) 응답:
  {
    "access": "<jwt access>",
    "refresh": "<jwt refresh>",
    "user_id": <int>,
    "nickname": "<string>",
    "role": "<string>"  // expected "student"
  }
- 실패(400) 응답 예시:
  - {"non_field_errors": ["해당 이메일이 존재하지 않습니다."]}
  - {"non_field_errors": ["비밀번호가 올바르지 않습니다."]}
  - {"non_field_errors": ["학생 계정만 로그인할 수 있습니다."]}

2) 학생 회원가입
- URL: POST /api/users/student/register/
- 요청 Body(JSON):
  - email(string, required, unique)
  - password(string, required)
  - nickname(string, required, max 50)
  - phone_number(string, required, unique, max 20)
- 처리: Django User 생성(username=email) → 비밀번호 해싱 저장 → LocalAccount 생성(role="student")
- 성공(201) 응답:
  {"message": "회원가입 성공"}
- 실패(400) 응답 예시:
  - {"email": ["이미 사용중인 이메일입니다."]}
  - 기타 필드 검증 에러

3) 구글 로그인(소셜 간이 구현)
- URL: POST /api/users/google/
- 요청 Body(JSON):
  - email(string, required)
  - name(string, required)
- 처리: email 기준 Django User get_or_create(username=email, first_name=name) → JWT Refresh 생성 → Access 토큰 추출
- 성공(200) 응답:
  {
    "token": "<jwt access>",
    "user": {
      "email": "<string>",
      "name": "<string>"
    }
  }
- 실패 처리: 별도 검증/예외 처리 없음(필드 누락 시 KeyError 가능성)

백엔드 현재 상태 요약
- Django 5.2 + DRF + SimpleJWT. INSTALLED_APPS 중 라우팅된 것은 `apps.users`뿐이며, `/api/users/` 하위 3개 엔드포인트만 동작함.
- 다른 앱(`learning`, `consultation`, `gamification`, `message`)은 views/urls 미구현 상태라 프론트 요청을 수용하는 API 없음.
- 모델 `LocalAccount` 필드: user(FK to auth_user), phone_number(unique), nickname, type, role, created_at. 회원가입 시 role="student", type 미설정.

백엔드 앱별 프론트 연결 필요 사항
- users: 이미 연결됨. 프론트 로그인/회원가입/구글 로그인에 `/api/users/student/login`, `/api/users/student/register`, `/api/users/google` 사용 예정. 현재 프론트는 하드코딩 분기라 호출 코드 추가 필요.
- learning: 엔드포인트 없음. 프론트의 코스 목록/공지/학습자료/과제/메시지/팀 협업(API 필요 목록 4~7번 참고)을 담당할 후보 앱. `apps.learning`에 course/assignment/material/session 등 모델·view·urls 구현 필요.
- consultation: 엔드포인트 없음. 프론트 상담(CounselSection)과 연결할 상담 목록/메시지 API를 여기서 설계/구현 가능(프론트 요구는 2번 항목 참고).
- message: 엔드포인트 없음. 코스별 메시지함(코스 메시지 페이지)나 1:1 메시지 기능을 이 앱으로 구성 가능. 프론트 요구는 4번 코스 메시지 API 참고.
- gamification: 엔드포인트 없음. 레벨/출석/뱃지 등(프론트 MyLevel, 출석 현황)과 연결할 후보. 현재 출석 조회만 프론트에서 `/api/attendance/status`를 호출하므로 여기 또는 별도 앱에서 구현 필요.

[프론트엔드] 사용/요구 API
1) 출석 현황 조회 (미구현 백엔드)
- 호출: GET /api/attendance/status (frontend/app/student/mypage/attendance/page.js)
- 기대 응답(JSON): 일자별 상태를 나타내는 필드 중 아무 조합이나 가능.
  - 1일차: firstDayStatus | first | (fallback 기본값: "done")
  - 2일차: secondDayStatus | second | day2
  - 3일차: thirdDayStatus | third | day3
  - 4일차: fourthDayStatus | fourth | day4
  - 5일차: fifthDayStatus | fifth | day5
  - 6일차: sixthDayStatus | sixth | day6
- 상태 값: "done" | "current" | "upcoming" | true/false | "T"/"F"
  - true 또는 "T" → "current", false 또는 "F" → "upcoming"
- 비고: 응답이 없거나 파싱 실패 시 프론트는 기본 단계 진행 상태(1~3 done, 4 current, 5~6 upcoming)로 대체 표시함.

2) 상담(consultation) 관련 화면
- 프론트 위치: `frontend/app/student/mypage/counsel/CounselSection.js`
- 현재 상태: 모든 상담 목록/메시지 CRUD가 컴포넌트 로컬 상태로만 동작하며, API 호출은 없음.
- 필요 예상 API(미구현, 참고용):
  - 상담 목록 조회: GET /api/consultations/ → [{id,title,status,date,...}]
  - 상담 상세/메시지 조회: GET /api/consultations/{id}/messages
  - 새 상담 생성: POST /api/consultations/ (title/내용)
  - 메시지 전송: POST /api/consultations/{id}/messages (text)
  - 상담 종료/삭제 등: PATCH/DELETE /api/consultations/{id}

3) 로그인/회원가입 플로우 (미연동)
- 로그인(`/app/page.js`): ID/PW로 단순 분기만 수행. 실제 동작 시 `/api/users/student/login/` (또는 관리자 전용 로그인 API)로 요청 후 역할에 따라 리다이렉트 필요.
- 회원가입(`/app/signup`, `/app/signup/form`): 폼 입력 후 알림만 띄움. 실제 동작 시
  - 학생 가입: POST /api/users/student/register/ (백엔드 존재)
  - 관리자/매니저 가입: 별도 API 필요(미구현)

4) 학생 대시보드/강의실 영역 (모두 mock 데이터 사용 → API 필요)
- 코스 목록: `frontend/app/student/page.js`, `frontend/data/mock-courses.js`
  - 필요 API 예: GET /api/courses → [{id, category, title, color}]
- 코스 공지: `frontend/app/student/course/[id]/page.js`, `data/mock-notices.js`
  - 필요 API 예: GET /api/courses/{courseId}/notices → [{id,title,date,preview,content}]
- 과제 목록: `frontend/app/student/course/[id]/assignment/page.js`, `data/mock-assignments.js`
  - 필요 API 예: GET /api/courses/{courseId}/assignments → [{id,title,deadline,status,isSubmitted,fileUrl,...}]
- 과제 상세/제출: `frontend/app/student/course/[id]/assignment/[assignmentId]/page.js`
  - 필요 API 예:
    - GET /api/assignments/{id}
    - POST /api/assignments/{id}/submit (multipart file + memo) → 제출 상태/파일명 반환
- 주차 학습 자료: `frontend/app/student/course/[id]/learning/page.js`, `data/mock-learning.js`
  - 필요 API 예:
    - GET /api/courses/{courseId}/learning/progress → [{week,status}]
    - GET /api/courses/{courseId}/learning/weeks → [{id,title,materials:[{id,type,title,url}]}]
- 코스 메시지함: `frontend/app/student/course/[id]/message/page.js`, `data/mock-messages.js`
  - 필요 API 예:
    - GET /api/courses/{courseId}/messages → 리스트(보낸/받은 요약)
    - GET /api/messages/{id} → conversations[]
    - POST /api/messages (courseId, title, content, attachment?) → 새 메시지
    - POST /api/messages/{id}/reply (content, attachment?) → 답장
- 팀 협업: `frontend/app/student/course/[id]/team/*`, `data/mock-team.js`
  - 필요 API 예:
    - GET /api/courses/{courseId}/teams/{teamId} → members, files, chatMessages, meetings, researches
    - POST /api/teams/{teamId}/files (multipart) → 파일 업로드
    - GET /api/teams/{teamId}/files
    - GET /api/teams/{teamId}/chats, POST /api/teams/{teamId}/chats (text)
    - 회의록: GET /api/teams/{teamId}/meetings, GET /api/meetings/{id}, POST/PATCH for 내용 추가
- 팀 회의 상세: `frontend/app/student/course/[id]/team/meeting/[meetingId]/page.js`
  - 위 팀 협업 API로 meeting 내용/파일/채팅 재사용 가능

5) 마이페이지 영역 (모두 로컬 상태/모의 데이터 → API 필요)
- 내 정보: `frontend/app/student/mypage/infosection/InfoSection.js`, `data/mock-user.js`
  - 필요 API 예: GET /api/me, PATCH /api/me (name, organization, email, solvedAc, profileImage 업로드)
- My Level/스테이지: `frontend/app/student/mypage/mylevel/*` (로직/정적 스테이지)
  - 필요 API 예: GET /api/me/level → {exp, trait, badges, background, submarine...}
- 1:1 상담: 위 2)에서 별도 설계 필요
- 수업 일정: `frontend/app/student/mypage/schedule/ScheduleSection.js` (로컬 캘린더)
  - 필요 API 예:
    - GET /api/me/schedules → 개인 일정/강의 일정 합산 데이터
    - POST/PATCH/DELETE /api/me/schedules/{id} → 개인 일정 CRUD
    - 강의 일정 표시를 위해:
      - GET /api/courses (내 수강 목록)
      - GET /api/courses/{courseId}/sessions → [{date, title, slot, status}] 형태로 수업 요일/특강/시험 일정을 반환
    - 프론트는 월간 캘린더에 `course`와 `status`를 표시하므로 응답에 course 이름/ID와 색상 매핑 정보가 있으면 좋음.

6) DIMC (검사/결과) - 외부 링크 + 더미 결과
- DIMC 검사: `/student/dimc`는 외부 사이트 링크만 제공.
- 결과: `/student/dimc/result`가 `data/mock-dimcresult.js` 사용.
  - 필요 API 예: GET /api/dimc/result → {scores:{I,D,M,C}, descriptions:{...}} (사용자별)

7) 강의 만족도 조사 (더미 설문)
- 위치: `frontend/app/student/eval/page.js`, `data/mock-courses.js`, QUESTIONS 상수 사용.
- 필요 API 예:
  - GET /api/courses (평가 대상 리스트)
  - GET /api/evals/questions → [문항]
  - POST /api/evals/responses (courseId, answers[1..n]) → 저장

8) 기타 요약
- 현재 프론트에서 네트워크 요청은 출석 현황 하나뿐이며, 나머지 화면은 모두 더미 데이터/로컬 상태를 사용. 상기 엔드포인트가 준비돼야 실제 연동 가능.

추가 메모
- 현재 project urls.py에 연결된 앱은 users 뿐이며, learning/consultation/gamification/message 앱은 엔드포인트 없음.
- Django admin은 /admin/ 로 접근 가능(기본 기능).
